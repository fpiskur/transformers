{"ast":null,"code":"import _objectSpread from \"/home/chof/Projects/transformers/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _toConsumableArray from \"/home/chof/Projects/transformers/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/home/chof/Projects/transformers/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/chof/Projects/transformers/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/chof/Projects/transformers/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/chof/Projects/transformers/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/chof/Projects/transformers/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/chof/Projects/transformers/src/components/TransformerForm.js\";\nimport React, { Component } from 'react';\nimport VehicleSelectList from '../components/VehicleSelectList.js';\nimport GearForm from '../components/GearForm.js';\n\nvar TransformerForm =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TransformerForm, _Component);\n\n  function TransformerForm() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, TransformerForm);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(TransformerForm)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      // Vehicles\n      availableVehicleTypes: _this.props.init.availableVehicleTypes,\n      availableVehicleModels: _this.props.init.availableVehicleModels,\n      typesDisabled: _this.props.init.typesDisabled,\n      modelsDisabled: _this.props.init.modelsDisabled,\n      // Input values\n      name: _this.props.init.name,\n      status: _this.props.init.status,\n      faction: _this.props.init.faction,\n      gear: _this.props.init.gear,\n      vehicleGroup: _this.props.init.vehicleGroup,\n      vehicleType: _this.props.init.vehicleType,\n      vehicleModel: _this.props.init.vehicleModel,\n      id: _this.props.init.id\n    };\n\n    _this.handleNameChange = function (e) {\n      var value = e.target.value;\n\n      _this.setState({\n        name: value\n      });\n    };\n\n    _this.handleStatusChange = function (e) {\n      var value = e.target.value;\n\n      _this.setState({\n        status: value\n      });\n    };\n\n    _this.handleFactionChange = function (e) {\n      var value = e.target.value;\n\n      _this.setState({\n        faction: value\n      });\n    };\n\n    _this.handleGroupChange = function (e) {\n      var value = e.target.value;\n\n      var uniqueVehicleTypes = _this.getUniqueVehicleTypes(value);\n\n      _this.setState({\n        availableVehicleTypes: uniqueVehicleTypes,\n        availableVehicleModels: [],\n        typesDisabled: false,\n        modelsDisabled: true,\n        vehicleGroup: value\n      });\n    };\n\n    _this.handleTypeChange = function (e) {\n      var value = e.target.value;\n\n      var uniqueVehicleModels = _this.getUniqueVehicleModels(value);\n\n      _this.setState({\n        availableVehicleModels: uniqueVehicleModels,\n        modelsDisabled: false,\n        vehicleType: value\n      });\n    };\n\n    _this.handleModelChange = function (e) {\n      var value = e.target.value;\n\n      _this.setState({\n        vehicleModel: value\n      });\n    };\n\n    _this.checkValidation = function (e) {\n      document.querySelectorAll(\"[required]\").forEach(function (element) {\n        element.classList.add('required');\n      });\n    };\n\n    _this.handleEnterKey = function (e) {\n      var code = e.keyCode || e.which;\n\n      if (code === 13) {\n        e.preventDefault();\n      }\n    };\n\n    _this.updateGear = function (newGearItems) {\n      var fullList = _toConsumableArray(new Set(_this.state.gear.concat(newGearItems)));\n\n      _this.setState({\n        gear: fullList\n      });\n    };\n\n    _this.deleteGearItem = function (index) {\n      _this.setState(function (state) {\n        return {\n          gear: state.gear.filter(function (item) {\n            return state.gear.indexOf(item) !== index;\n          })\n        };\n      });\n    };\n\n    _this.submitTransformer = function (e) {\n      e.preventDefault();\n      var data = _this.state;\n      var allowed = ['name', 'status', 'faction', 'gear', 'vehicleGroup', 'vehicleType', 'vehicleModel', 'id'];\n      var prepared = Object.keys(data).filter(function (key) {\n        return allowed.includes(key);\n      }).reduce(function (obj, key) {\n        obj[key] = data[key];\n        return obj;\n      }, {});\n\n      _this.props.method(_objectSpread({}, prepared));\n    };\n\n    return _this;\n  }\n\n  _createClass(TransformerForm, [{\n    key: \"UNSAFE_componentWillMount\",\n    value: function UNSAFE_componentWillMount() {\n      // deprecated!\n      // Update state of vehicle properties from props\n      var availableVehicleTypes = this.getUniqueVehicleTypes(this.state.vehicleGroup);\n      var availableVehicleModels = this.getUniqueVehicleModels(this.state.vehicleType);\n      this.setState({\n        availableVehicleTypes: availableVehicleTypes,\n        availableVehicleModels: availableVehicleModels,\n        vehicleType: this.props.init.vehicleType,\n        vehicleModel: this.props.init.vehicleModel\n      });\n    }\n  }, {\n    key: \"getUniqueVehicleGroups\",\n    value: function getUniqueVehicleGroups() {\n      return _toConsumableArray(new Set(this.props.vehicleTypes.map(function (vehicle) {\n        return vehicle.group;\n      })));\n    }\n  }, {\n    key: \"getUniqueVehicleTypes\",\n    value: function getUniqueVehicleTypes(vehicleGroup) {\n      var allGroupTypes = this.props.vehicleTypes.filter(function (selectedType) {\n        return selectedType.group === vehicleGroup;\n      }).map(function (vehicle) {\n        return vehicle.type;\n      });\n      return _toConsumableArray(new Set(allGroupTypes));\n    }\n  }, {\n    key: \"getUniqueVehicleModels\",\n    value: function getUniqueVehicleModels(vehicleType) {\n      return this.props.vehicleTypes.filter(function (selectedModel) {\n        return selectedModel.type === vehicleType;\n      }).map(function (vehicle) {\n        return vehicle.model;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var factions = this.props.factions;\n      return React.createElement(\"form\", {\n        onSubmit: this.submitTransformer,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row my-5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-md-7 col-lg-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"name\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"Name: \", React.createElement(\"abbr\", {\n        title: \"Required\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }, \"*\"))), React.createElement(\"div\", {\n        className: \"col-12 col-md-9\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        id: \"name\",\n        placeholder: \"Enter name\",\n        value: this.state.name,\n        onChange: this.handleNameChange,\n        onKeyPress: this.handleEnterKey,\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }))), React.createElement(\"div\", {\n        className: \"row form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"status\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, \"Status: \", React.createElement(\"abbr\", {\n        title: \"Required\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162\n        },\n        __self: this\n      }, \"*\"))), React.createElement(\"div\", {\n        className: \"col-12 col-md-9\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, React.createElement(\"select\", {\n        className: \"form-control custom-select\",\n        id: \"status\",\n        value: this.state.status,\n        onChange: this.handleStatusChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"OK\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, \"OK\"), React.createElement(\"option\", {\n        value: \"INJURED\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, \"INJURED\"), React.createElement(\"option\", {\n        value: \"MIA\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, \"MIA\")))), React.createElement(\"div\", {\n        className: \"row form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 col-md-3\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"label\", {\n        htmlFor: \"faction\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, \"Faction: \", React.createElement(\"abbr\", {\n        title: \"Required\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, \"*\"))), React.createElement(\"div\", {\n        className: \"col-12 col-md-9\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182\n        },\n        __self: this\n      }, React.createElement(\"select\", {\n        className: \"form-control custom-select\",\n        id: \"faction\",\n        value: this.state.faction,\n        onChange: this.handleFactionChange,\n        required: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        hidden: true,\n        value: \"\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }, \" -- choose faction -- \"), factions.map(function (faction) {\n        return React.createElement(\"option\", {\n          key: faction.id,\n          value: faction.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, faction.name);\n      }), \";\"))), React.createElement(GearForm, {\n        gear: this.state.gear,\n        addGearItems: this.updateGear,\n        deleteGearItem: this.deleteGearItem,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 198\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"col-12 col-md-5 col-lg-6\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"row form-group\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202\n        },\n        __self: this\n      }, React.createElement(\"fieldset\", {\n        className: \"w-100\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 mb-3\",\n        style: {\n          height: '38px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204\n        },\n        __self: this\n      }, React.createElement(\"legend\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, React.createElement(\"small\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"Vehicle properties \", React.createElement(\"abbr\", {\n        title: \"Required\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 205\n        },\n        __self: this\n      }, \"*\")))), React.createElement(VehicleSelectList, {\n        dropDownPlaceholder: \" -- vehicle group -- \",\n        optionsList: this.getUniqueVehicleGroups(),\n        disabled: false,\n        method: this.handleGroupChange,\n        default: this.state.vehicleGroup,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 208\n        },\n        __self: this\n      }), React.createElement(VehicleSelectList, {\n        dropDownPlaceholder: \" -- vehicle type -- \",\n        optionsList: this.state.availableVehicleTypes,\n        disabled: this.state.typesDisabled,\n        method: this.handleTypeChange,\n        default: this.state.vehicleType,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 216\n        },\n        __self: this\n      }), React.createElement(VehicleSelectList, {\n        dropDownPlaceholder: \" -- vehicle model -- \",\n        optionsList: this.state.availableVehicleModels,\n        disabled: this.state.modelsDisabled,\n        method: this.handleModelChange,\n        default: this.state.vehicleModel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      }))))), React.createElement(\"div\", {\n        className: \"row\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 238\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"col-12 text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 239\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary btn-lg\",\n        onClick: this.checkValidation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 240\n        },\n        __self: this\n      }, this.props.submitText))));\n    }\n  }]);\n\n  return TransformerForm;\n}(Component);\n\nexport default TransformerForm;","map":{"version":3,"sources":["/home/chof/Projects/transformers/src/components/TransformerForm.js"],"names":["React","Component","VehicleSelectList","GearForm","TransformerForm","state","availableVehicleTypes","props","init","availableVehicleModels","typesDisabled","modelsDisabled","name","status","faction","gear","vehicleGroup","vehicleType","vehicleModel","id","handleNameChange","e","value","target","setState","handleStatusChange","handleFactionChange","handleGroupChange","uniqueVehicleTypes","getUniqueVehicleTypes","handleTypeChange","uniqueVehicleModels","getUniqueVehicleModels","handleModelChange","checkValidation","document","querySelectorAll","forEach","element","classList","add","handleEnterKey","code","keyCode","which","preventDefault","updateGear","newGearItems","fullList","Set","concat","deleteGearItem","index","filter","item","indexOf","submitTransformer","data","allowed","prepared","Object","keys","key","includes","reduce","obj","method","vehicleTypes","map","vehicle","group","allGroupTypes","selectedType","type","selectedModel","model","factions","height","getUniqueVehicleGroups","submitText"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport VehicleSelectList from '../components/VehicleSelectList.js';\nimport GearForm from '../components/GearForm.js';\n\nclass TransformerForm extends Component {\n\n  state = {\n    // Vehicles\n    availableVehicleTypes: this.props.init.availableVehicleTypes,\n    availableVehicleModels: this.props.init.availableVehicleModels,\n    typesDisabled: this.props.init.typesDisabled,\n    modelsDisabled: this.props.init.modelsDisabled,\n    // Input values\n    name: this.props.init.name,\n    status: this.props.init.status,\n    faction: this.props.init.faction,\n    gear: this.props.init.gear,\n    vehicleGroup: this.props.init.vehicleGroup,\n    vehicleType: this.props.init.vehicleType,\n    vehicleModel: this.props.init.vehicleModel,\n    id: this.props.init.id\n  }\n\n  UNSAFE_componentWillMount() {   // deprecated!\n    // Update state of vehicle properties from props\n    let availableVehicleTypes = this.getUniqueVehicleTypes(this.state.vehicleGroup);\n    let availableVehicleModels = this.getUniqueVehicleModels(this.state.vehicleType);\n    this.setState({\n      availableVehicleTypes: availableVehicleTypes,\n      availableVehicleModels: availableVehicleModels,\n      vehicleType: this.props.init.vehicleType,\n      vehicleModel: this.props.init.vehicleModel\n    });\n  }\n\n  getUniqueVehicleGroups() {\n    return [...new Set(this.props.vehicleTypes.map(vehicle => vehicle.group))];\n  }\n\n  getUniqueVehicleTypes(vehicleGroup) {\n    let allGroupTypes = this.props.vehicleTypes.filter(selectedType => selectedType.group === vehicleGroup)\n                                           .map(vehicle => vehicle.type);\n    return [...new Set(allGroupTypes)];\n  }\n\n  getUniqueVehicleModels(vehicleType) {\n    return this.props.vehicleTypes.filter(selectedModel => selectedModel.type === vehicleType)\n                                  .map(vehicle => vehicle.model);\n  }\n\n  handleNameChange = (e) => {\n    let {value} = e.target;\n    this.setState({ name: value });\n  }\n\n  handleStatusChange = (e) => {\n    let {value} = e.target;\n    this.setState({ status: value });\n  }\n\n  handleFactionChange = (e) => {\n    let {value} = e.target;\n    this.setState({ faction: value });\n  }\n\n  handleGroupChange = (e) => {\n    let {value} = e.target;\n    let uniqueVehicleTypes = this.getUniqueVehicleTypes(value);\n\n    this.setState({\n      availableVehicleTypes: uniqueVehicleTypes,\n      availableVehicleModels: [],\n      typesDisabled: false,\n      modelsDisabled: true,\n      vehicleGroup: value\n    });\n  }\n\n  handleTypeChange = (e) => {\n    let {value} = e.target;\n    let uniqueVehicleModels = this.getUniqueVehicleModels(value);\n\n    this.setState({\n      availableVehicleModels: uniqueVehicleModels,\n      modelsDisabled: false,\n      vehicleType: value\n    });\n  }\n\n  handleModelChange = (e) => {\n    let {value} = e.target;\n    this.setState({ vehicleModel: value });\n  }\n\n  // Give required elements :invalid style to mimic Firefox's :-moz-ui-invalid\n  checkValidation = (e) => {\n    document.querySelectorAll(\"[required]\").forEach(element =>  {\n      element.classList.add('required')\n    });\n  }\n\n  // Prevent from submitting a form on \"Enter\"\n  handleEnterKey = (e) => {\n    let code = e.keyCode || e.which;\n    if(code === 13) {\n        e.preventDefault();\n    }\n  }\n\n  updateGear = (newGearItems) => {\n    let fullList = [...new Set(this.state.gear.concat(newGearItems))]\n    this.setState({ gear: fullList });\n  }\n\n  deleteGearItem = (index) => {\n    this.setState(state => ({ gear: state.gear.filter(item => state.gear.indexOf(item) !== index) }));\n  }\n\n  // Collect data from state and pass it to method() in AddNewPage or EditPage\n  submitTransformer = (e) => {\n    e.preventDefault()\n    let data = this.state;\n    let allowed = [ 'name', 'status', 'faction', 'gear', 'vehicleGroup', 'vehicleType', 'vehicleModel', 'id' ];\n    let prepared = Object.keys(data)\n      .filter(key => allowed.includes(key))\n      .reduce((obj, key) => {\n        obj[key] = data[key];\n        return obj;\n      }, {});\n    this.props.method({...prepared});\n  };\n\n  render() {\n\n    let { factions } = this.props;\n\n    return (\n\n        <form onSubmit={this.submitTransformer}>\n          <div className=\"row my-5\">\n            <div className=\"col-12 col-md-7 col-lg-6\">\n              <div className=\"row form-group\">\n                <div className=\"col-12 col-md-3\">\n                  <label htmlFor=\"name\">Name: <abbr title=\"Required\">*</abbr></label>\n                </div>\n                <div className=\"col-12 col-md-9\">\n                  <input\n                    type=\"text\"\n                    className=\"form-control\"\n                    id=\"name\"\n                    placeholder=\"Enter name\"\n                    value={this.state.name}\n                    onChange={this.handleNameChange}\n                    onKeyPress={this.handleEnterKey}\n                    required\n                  />\n                </div>\n              </div>\n\n              <div className=\"row form-group\">\n                <div className=\"col-12 col-md-3\">\n                  <label htmlFor=\"status\">Status: <abbr title=\"Required\">*</abbr></label>\n                </div>\n                <div className=\"col-12 col-md-9\">\n                  <select\n                    className=\"form-control custom-select\"\n                    id=\"status\"\n                    value={this.state.status}\n                    onChange={this.handleStatusChange}\n                  >\n                    <option value=\"OK\">OK</option>\n                    <option value=\"INJURED\">INJURED</option>\n                    <option value=\"MIA\">MIA</option>\n                  </select>\n                </div>\n              </div>\n\n              <div className=\"row form-group\">\n                <div className=\"col-12 col-md-3\">\n                  <label htmlFor=\"faction\">Faction: <abbr title=\"Required\">*</abbr></label>\n                </div>\n                <div className=\"col-12 col-md-9\">\n                  <select\n                    className=\"form-control custom-select\"\n                    id=\"faction\"\n                    value={this.state.faction}\n                    onChange={this.handleFactionChange}\n                    required\n                  >\n                    <option hidden value=\"\"> -- choose faction -- </option>\n                    {factions.map(faction => (\n                      <option key={faction.id} value={faction.name}>{ faction.name }</option>\n                    ))};\n                  </select>\n                </div>\n              </div>\n\n              <GearForm gear={this.state.gear} addGearItems={this.updateGear} deleteGearItem={this.deleteGearItem} />\n            </div>\n\n            <div className=\"col-12 col-md-5 col-lg-6\">\n              <div className=\"row form-group\">\n                <fieldset className=\"w-100\">\n                  <div className=\"col-12 mb-3\" style={{ height: '38px' }}>\n                    <legend><small>Vehicle properties <abbr title=\"Required\">*</abbr></small></legend>\n                  </div>\n\n                  <VehicleSelectList\n                    dropDownPlaceholder = \" -- vehicle group -- \"\n                    optionsList = {this.getUniqueVehicleGroups()}\n                    disabled = {false}\n                    method = {this.handleGroupChange}\n                    default = {this.state.vehicleGroup}\n                  />\n\n                  <VehicleSelectList\n                    dropDownPlaceholder = \" -- vehicle type -- \"\n                    optionsList = {this.state.availableVehicleTypes}\n                    disabled = {this.state.typesDisabled}\n                    method = {this.handleTypeChange}\n                    default = {this.state.vehicleType}\n                  />\n\n                  <VehicleSelectList\n                    dropDownPlaceholder = \" -- vehicle model -- \"\n                    optionsList = {this.state.availableVehicleModels}\n                    disabled = {this.state.modelsDisabled}\n                    method = {this.handleModelChange}\n                    default = {this.state.vehicleModel}\n                  />\n\n                </fieldset>\n              </div>\n            </div>\n\n          </div>\n\n          <div className=\"row\">\n            <div className=\"col-12 text-center\">\n              <button type=\"submit\" className=\"btn btn-primary btn-lg\" onClick={this.checkValidation}>{this.props.submitText}</button>\n            </div>\n          </div>\n\n        </form>\n\n    );\n\n  }\n\n}\n\nexport default TransformerForm;\n"]},"metadata":{},"sourceType":"module"}